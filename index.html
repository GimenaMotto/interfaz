<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Oposiciones Arquitectos Madrid Facturación</title>
  <style>
    /* Estilos para simular la consola */
    #console {
      background-color: #1E1E1E;
      color: #FFFFFF;
      font-family: monospace;
      padding: 10px;
      border: 1px solid #CCCCCC;
      width: 80%;
      height: 200px;
      overflow-y: auto;
      margin-top: 20px; /* Agrega espacio arriba de la consola */
    }

    /* Estilos para el contenedor principal */
    #container {
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    /* Estilos para los elementos del formulario */
    label {
      margin-top: 10px; /* Agrega espacio arriba de cada label */
    }

    input[type="number"],
    input[type="file"],
    button {
      margin-top: 5px; /* Agrega espacio arriba de los input y el botón */
    }

    button {
      padding: 8px 20px; /* Aumenta el tamaño del botón */
    }

    /* Estilos para colocar elementos uno al lado del otro */
    .flex-container {
      display: flex;
      align-items: center;
    }

    .flex-item {
      margin-right: 10px; /* Agrega espacio entre elementos */
    }
  </style>
</head>
<body>
  <div id="container">
    <h3>Datos alumnos/as y última factura</h3>
    <div class="flex-container">
      <div class="flex-item">
        <label for="lastNumberInput">Número de factura inicial 20230</label>
        <input type="number" id="lastNumberInput" placeholder="Ingrese el número de factura">
      </div>
      <div class="flex-item">
        <label for="jsonFileInput">Seleccione un archivo JSON:</label>
        <input type="file" id="jsonFileInput">
      </div>
      <div class="flex-item">
        <button onclick="loadData()">Cargar datos</button>
      </div>
    </div>

    <!-- Elemento para simular la consola -->
    <div id="console"></div>

  </div>

  <div class="flex-item">
    <button onclick="selectDirectoryAndGeneratePDFs()">Generar PDFs</button> <!-- Botón para generar los PDFs -->
  </div>

      <!-- Botón para generar y guardar el Excel -->
      <div class="flex-item">
        <button onclick="generateExcel()">Generar lista</button>
      </div>
    </div>
  <script>
    // Función para cargar el archivo JSON y el número de la última factura
    function loadData() {
      const fileInput = document.getElementById('jsonFileInput')
      const file = fileInput.files[0]
      const lastNumberInput = document.getElementById('lastNumberInput').value

      if (file && lastNumberInput !== '') {
        const reader = new FileReader()

        reader.onload = function(event) {
          const jsonContent = event.target.result;
          const data = {
            jsonContent: jsonContent,
            lastNumberInput: lastNumberInput
          };

          // Envía el contenido JSON y el número de factura al proceso principal (main.js)
          window.ipcRenderer.send('load-data', data)

          // Mostrar el resultado en la consola personalizada
          const consoleElement = document.getElementById('console')
          const message = `Número de la última factura: ${lastNumberInput}\nDatos del JSON: ${jsonContent}`
          consoleElement.innerText = message
        }

        reader.readAsText(file)
      } else {
        console.error('Error: Por favor, seleccione un archivo JSON y escriba el número de la última factura.')
      }
    }

    // Nueva función para seleccionar directorio y generar los PDFs
    function selectDirectoryAndGeneratePDFs() {
      // Envía el evento para seleccionar el directorio antes de generar los PDFs
      window.ipcRenderer.send('select-directory')
    }

      // Nueva función para generar y guardar el Excel
      function generateExcel() {
      // Envía el evento para generar la lista Excel
      window.ipcRenderer.send('generate-excel-list')
    }
  </script>
</body>
</html>
